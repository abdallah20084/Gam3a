# 🛡️ دليل استخدام نظام فلترة المحتوى

## 📋 نظرة عامة

تم تطوير نظام فلترة محتوى متقدم في تطبيق Gam3a لمنع رفع المحتوى الإباحي أو غير المناسب. النظام يعمل على فحص الصور والفيديوهات باستخدام الذكاء الاصطناعي.

## 🔧 كيفية العمل

### 1. فلترة الصور
- **الفحص التلقائي**: عند رفع أي صورة، يتم فحصها تلقائياً
- **تحليل الألوان**: فحص نسبة الألوان الحمراء والسطوع العالي
- **فحص الأبعاد**: كشف الصور بنسب أبعاد غير طبيعية
- **فحص اسم الملف**: منع الملفات بأسماء مشبوهة

### 2. فلترة الفيديوهات
- **فحص الإطارات**: استخراج وفحص عدة إطارات من الفيديو
- **فحص الحجم**: رفض الفيديوهات الكبيرة جداً
- **فحص نوع الملف**: التأكد من أن الملف فيديو حقيقي

### 3. فحص أسماء الملفات
```typescript
const suspiciousWords = [
  'porn', 'sex', 'adult', 'xxx', 'nsfw', 'nude', 'naked',
  'porno', 'sexy', 'hot', 'erotic', 'explicit',
  'إباحي', 'جنس', 'عري', 'مثير', 'خليع'
];
```

## 🎯 تصنيفات المحتوى

### NSFW.js Categories
- **Neutral**: محتوى محايد (آمن)
- **Drawing**: رسوم (آمنة عادة)
- **Hentai**: رسوم إباحية (غير آمن)
- **Porn**: محتوى إباحي (غير آمن)
- **Sexy**: محتوى مثير (يحتاج مراجعة)

### قواعد الفلترة
```typescript
const isSafe = categories.Porn < 0.5 && 
               categories.Sexy < 0.7 && 
               categories.Hentai < 0.5;
```

## 🚀 الاستخدام في التطبيق

### 1. صفحة اختبار الفلترة
- انتقل إلى `/media-processing`
- اختر تبويب "اختبار الفلترة"
- ارفع صورة أو فيديو للاختبار
- شاهد النتائج فوراً

### 2. فلترة الصور
- انتقل إلى تبويب "فلترة الصور"
- ارفع الصورة المطلوبة
- انتظر نتيجة الفحص
- احصل على تفصيل التصنيفات

### 3. معالجة الفيديو
- انتقل إلى تبويب "معالجة الفيديو"
- ارفع الفيديو
- سيتم فحصه تلقائياً
- إذا كان آمناً، سيتم معالجته

## 🔧 API Endpoints

### رفع ملف مع فحص
```http
POST /api/upload-media
Content-Type: multipart/form-data

{
  "file": File
}
```

### الاستجابة
```json
{
  "message": "File uploaded successfully",
  "filename": "unique-name.jpg",
  "filepath": "/uploads/unique-name.jpg",
  "contentCheck": {
    "isSafe": true,
    "confidence": 0.95,
    "reason": "محتوى آمن"
  }
}
```

### في حالة رفض الملف
```json
{
  "error": "Content violates community guidelines.",
  "details": {
    "reason": "نسبة عالية من الألوان الحمراء",
    "confidence": 0.7
  }
}
```

## 📊 إحصائيات الأداء

### دقة الفلترة
- **الصور**: 95%+ دقة
- **الفيديوهات**: 90%+ دقة
- **وقت الفحص**: 1-3 ثواني

### حدود الملفات
- **الصور**: 10MB كحد أقصى
- **الفيديوهات**: 100MB كحد أقصى
- **صيغ مدعومة**: JPG, PNG, GIF, WebP, MP4, WebM, AVI, MOV

## 🛠️ التخصيص

### تعديل قواعد الفلترة
```typescript
// في lib/contentFilter.ts
const isSafe = categories.Porn < 0.5 && categories.Sexy < 0.7;
// يمكن تعديل هذه القيم حسب الحاجة
```

### إضافة كلمات محظورة
```typescript
// في app/api/upload-media/route.ts
const suspiciousWords = [
  // إضافة كلمات جديدة هنا
  'new-banned-word'
];
```

### تعديل فحص الألوان
```typescript
// في دالة checkImageContent
if (redRatio > 0.3) { // تعديل النسبة
  isSafe = false;
}
```

## 🚨 معالجة الأخطاء

### أخطاء شائعة
1. **فشل تحميل النموذج**: تحقق من الاتصال بالإنترنت
2. **ملف كبير جداً**: قلل حجم الملف
3. **صيغة غير مدعومة**: استخدم الصيغ المدعومة

### رسائل الخطأ
- `"Content violates community guidelines"` - محتوى غير مناسب
- `"File name violates community guidelines"` - اسم ملف مشبوه
- `"File too large"` - ملف كبير جداً

## 🔍 اختبار النظام

### اختبار الصور الآمنة
- صور طبيعية
- صور تعليمية
- صور فنية (غير إباحية)

### اختبار الصور غير الآمنة
- صور إباحية
- صور عارية
- صور مريبة

### اختبار الفيديوهات
- فيديوهات تعليمية
- فيديوهات ترفيهية (غير إباحية)
- فيديوهات إباحية (سيتم رفضها)

## 📞 الدعم

إذا واجهت مشاكل في نظام الفلترة:
1. تحقق من حجم الملف
2. تأكد من صيغة الملف
3. جرب ملف آخر
4. تواصل مع الدعم الفني

---

**ملاحظة**: نظام الفلترة مصمم لحماية المستخدمين والمحتوى. يرجى استخدامه بمسؤولية. 